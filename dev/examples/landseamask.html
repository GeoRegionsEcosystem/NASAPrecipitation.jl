<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Land-Sea Mask Filtering · NASAPrecipitation.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="NASAPrecipitation.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">NASAPrecipitation.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Dataset Basics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../datasets/npd.html">NASA Precipitation Datasets</a></li><li><a class="tocitem" href="../datasets/imerg.html">GPM IMERG Datasets</a></li><li><a class="tocitem" href="../datasets/trmm.html">TRMM TMPA Datasets</a></li><li><a class="tocitem" href="../datasets/landseamask.html">Land-Sea Mask Datasets</a></li><li><a class="tocitem" href="../datasets/georegions.html">A Basic Primer to <code>GeoRegion</code>s</a></li></ul></li><li><a class="tocitem" href="../download.html">Downloading Data</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="download.html">Downloading IMERG Data</a></li><li class="is-active"><a class="tocitem" href="landseamask.html">Land-Sea Mask Filtering</a><ul class="internal"><li><a class="tocitem" href="#.-Loading-TRMM-Daily-Data"><span>1. Loading TRMM Daily Data</span></a></li><li><a class="tocitem" href="#.-Loading-Land-Sea-Mask"><span>2. Loading Land-Sea Mask</span></a></li><li><a class="tocitem" href="#.-Read-the-Data-using-NCDatasets"><span>3. Read the Data using NCDatasets</span></a></li><li><a class="tocitem" href="#.-Extract-data-over-land-and-over-the-ocea"><span>4. Extract data over land and over the ocea</span></a></li><li><a class="tocitem" href="#.-Plotting-the-data-using-ProPlot"><span>5. Plotting the data using ProPlot</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="landseamask.html">Land-Sea Mask Filtering</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="landseamask.html">Land-Sea Mask Filtering</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/natgeo-wong/NASAPrecipitation.jl/blob/master/docs/src/examples/landseamask.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Filtering-TRMM-Data-using-the-Land-Sea-Masks"><a class="docs-heading-anchor" href="#Filtering-TRMM-Data-using-the-Land-Sea-Masks">Filtering TRMM Data using the Land-Sea Masks</a><a id="Filtering-TRMM-Data-using-the-Land-Sea-Masks-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering-TRMM-Data-using-the-Land-Sea-Masks" title="Permalink"></a></h1><p>In this example, we download near real-time TRMM daily data for the month of February 2012 in the West African (<code>WAF</code>) <code>GeoRegion</code>, and use the TRMM Land-Sea Mask to differentiate between land and sea regions.</p><h2 id=".-Loading-TRMM-Daily-Data"><a class="docs-heading-anchor" href="#.-Loading-TRMM-Daily-Data">1. Loading TRMM Daily Data</a><a id=".-Loading-TRMM-Daily-Data-1"></a><a class="docs-heading-anchor-permalink" href="#.-Loading-TRMM-Daily-Data" title="Permalink"></a></h2><p>We start first by loading the TRMM daily data</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using NASAPrecipitation</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; npd = TRMMDaily(dtbeg=Date(2012,2,1),dtend=Date(2012,2,1),sroot=joinpath(pwd(),&quot;..&quot;,&quot;..&quot;,&quot;data&quot;)) # NASAPrecipitation.jl downloads daily data month-by-month</code><code class="nohighlight hljs ansi" style="display:block;">[ Info: 2021-08-25T05:38:10.675 - NASAPrecipitation.jl - Setting up data structure containing information on Final TRMM Daily data to be downloaded
The NASA Precipitation Dataset {String,Date} has the following properties:
    Dataset ID      (npdID) : trmmdaily
    Logging Name    (lname) : Final TRMM Daily
    DOI URL          (doi)  : 10.5067/TRMM/TMPA/DAY/7
    Data Directory  (sroot) : /home/runner/work/NASAPrecipitation.jl/NASAPrecipitation.jl/docs/build/examples/../../data/trmmdaily
    Date Begin      (dtbeg) : 2012-02-01
    Date End        (dtend) : 2012-02-29
    Timestep                : 1 Day
    Data Resolution         : 0.25º
    Data Server     (hroot) : https://disc2.gesdisc.eosdis.nasa.gov/opendap/TRMM_L3/TRMM_3B42_Daily.7</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; geo = GeoRegion(&quot;AR6_WAF&quot;) # AR6 regions are automatically defined in GeoRegions.jl v2 and above</code><code class="nohighlight hljs ansi" style="display:block;">[ Info: 2021-08-25T05:38:10.701 - GeoRegions.jl - Retrieving information for the GeoRegion defined by the ID AR6_WAF
[ Info: 2021-08-25T05:38:10.702 - GeoRegions.jl - Checking to see if the ID AR6_WAF is in use
[ Info: 2021-08-25T05:38:10.702 - GeoRegions.jl - The ID AR6_WAF is already in use
The Polygonal Region AR6_WAF has the following properties:
    Region ID (regID) : AR6_WAF
    Parent ID (parID) : GLB
    Name       (name) : Western Africa
    Bounds  (N,S,E,W) : [14.7, 0.0, 15.0, -20.0]
    Shape     (shape) : Point2{Float64}[[-20.0, 7.6], [-20.0, 14.7], [15.0, 14.7], [8.0, 0.0], [-20.0, 7.6]]
        (is180,is360) : (true, false)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; download(npd,geo) # will fail because .netrc and .dodsrc are not provided</code><code class="nohighlight hljs ansi" style="display:block;">[ Info: 2021-08-25T05:38:11.856 - NASAPrecipitation.jl - Downloading Final TRMM Daily data for the Western Africa GeoRegion from 2012-02-01 to 2012-02-29
[ Info: 2021-08-25T05:38:11.856 - GeoRegions.jl - Retrieving information for the GeoRegion defined by the ID TRMM
[ Info: 2021-08-25T05:38:11.858 - GeoRegions.jl - Checking to see if the ID TRMM is in use
[ Info: 2021-08-25T05:38:11.858 - GeoRegions.jl - The ID TRMM is already in use
[ Info: 2021-08-25T05:38:11.858 - GeoRegions.jl - Performing a check to determine if the Western Africa GeoRegion (AR6_WAF) is inside the Global TRMM Dataset GeoRegion (TRMM)
[ Info: 2021-08-25T05:38:11.858 - GeoRegions.jl - The GeoRegion AR6_WAF (Western Africa) is indeed a subset of the GeoRegion TRMM (Global TRMM Dataset)
[ Info: 2021-08-25T05:38:11.859 - GeoRegions.jl - Creating a RegionGrid for the Western Africa GeoRegion
[ Info: 2021-08-25T05:38:11.859 - GeoRegions.jl - Creating vector of latitude indices to extract ...
[ Info: 2021-08-25T05:38:11.859 - GeoRegions.jl - Creating vector of longitude indices to extract ...
[ Info: 2021-08-25T05:38:11.859 - GeoRegions.jl - Since the Western Africa GeoRegion is a PolyRegion, we need to defined a mask as well ...
[ Info: 2021-08-25T05:38:11.859 - NASAPrecipitation.jl - Preallocating temporary arrays for extraction of Final TRMM Daily data for the Western Africa GeoRegion from the original gridded dataset
[ Info: 2021-08-25T05:38:11.860 - NASAPrecipitation.jl - Downloading Final TRMM Daily data for the Western Africa GeoRegion from the NASA Earthdata servers using OPeNDAP protocols for 2012-2 ...
syntax error, unexpected WORD_WORD, expecting SCAN_ATTR or SCAN_DATASET or SCAN_ERROR
context: HTTP^ Basic: Access denied.
ERROR: NetCDF error: NetCDF: Authorization failure (NetCDF error code: -78)</code></pre><h2 id=".-Loading-Land-Sea-Mask"><a class="docs-heading-anchor" href="#.-Loading-Land-Sea-Mask">2. Loading Land-Sea Mask</a><a id=".-Loading-Land-Sea-Mask-1"></a><a class="docs-heading-anchor-permalink" href="#.-Loading-Land-Sea-Mask" title="Permalink"></a></h2><p>Next, we download the TRMM daily data</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using NASAPrecipitation</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; geo = GeoRegion(&quot;AR6_WAF&quot;) # AR6 regions are automatically defined in GeoRegions.jl v2 and above</code><code class="nohighlight hljs ansi" style="display:block;">[ Info: 2021-08-25T05:38:14.265 - GeoRegions.jl - Retrieving information for the GeoRegion defined by the ID AR6_WAF
[ Info: 2021-08-25T05:38:14.266 - GeoRegions.jl - Checking to see if the ID AR6_WAF is in use
[ Info: 2021-08-25T05:38:14.266 - GeoRegions.jl - The ID AR6_WAF is already in use
The Polygonal Region AR6_WAF has the following properties:
    Region ID (regID) : AR6_WAF
    Parent ID (parID) : GLB
    Name       (name) : Western Africa
    Bounds  (N,S,E,W) : [14.7, 0.0, 15.0, -20.0]
    Shape     (shape) : Point2{Float64}[[-20.0, 7.6], [-20.0, 14.7], [15.0, 14.7], [8.0, 0.0], [-20.0, 7.6]]
        (is180,is360) : (true, false)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; getTRMMlsm(geo,sroot=joinpath(pwd(),&quot;..&quot;,&quot;..&quot;,&quot;data&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">[ Info: 2021-08-25T05:38:15.288 - NASAPrecipitation.jl - Retrieving Land-Sea Mask for the TRMM-TMPA dataset
[ Info: 2021-08-25T05:38:15.288 - GeoRegions.jl - Retrieving information for the GeoRegion defined by the ID TRMMLSM
[ Info: 2021-08-25T05:38:15.289 - GeoRegions.jl - Checking to see if the ID TRMMLSM is in use
[ Info: 2021-08-25T05:38:15.289 - GeoRegions.jl - The ID TRMMLSM is already in use
[ Info: 2021-08-25T05:38:15.290 - GeoRegions.jl - Performing a check to determine if the Western Africa GeoRegion (AR6_WAF) is inside the Global TRMM LandSea Mask Dataset GeoRegion (TRMMLSM)
[ Info: 2021-08-25T05:38:15.290 - GeoRegions.jl - The GeoRegion AR6_WAF (Western Africa) is indeed a subset of the GeoRegion TRMMLSM (Global TRMM LandSea Mask Dataset)
[ Info: 2021-08-25T05:38:15.290 - GeoRegions.jl - Creating a RegionGrid for the Western Africa GeoRegion
[ Info: 2021-08-25T05:38:15.290 - GeoRegions.jl - Creating vector of latitude indices to extract ...
[ Info: 2021-08-25T05:38:15.290 - GeoRegions.jl - Creating vector of longitude indices to extract ...
[ Info: 2021-08-25T05:38:15.290 - GeoRegions.jl - Since the Western Africa GeoRegion is a PolyRegion, we need to defined a mask as well ...
[ Info: 2021-08-25T05:38:15.290 - NASAPrecipitation.jl - Preallocating temporary array for extraction of TRMM-TMPA Land-Sea Mask data for the Western Africa GeoRegion from the original global gridded dataset
[ Info: 2021-08-25T05:38:15.291 - NASAPrecipitation.jl - Retrieving the original TRMM-TMPA Land-Sea Mask data from NASA&#39;s EOSDIS OPeNDAP servers
syntax error, unexpected WORD_WORD, expecting SCAN_ATTR or SCAN_DATASET or SCAN_ERROR
context: HTTP^ Basic: Access denied.
ERROR: NetCDF error: NetCDF: Authorization failure (NetCDF error code: -78)</code></pre><h2 id=".-Read-the-Data-using-NCDatasets"><a class="docs-heading-anchor" href="#.-Read-the-Data-using-NCDatasets">3. Read the Data using NCDatasets</a><a id=".-Read-the-Data-using-NCDatasets-1"></a><a class="docs-heading-anchor-permalink" href="#.-Read-the-Data-using-NCDatasets" title="Permalink"></a></h2><p>We use NCDatasets to read the data</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using NCDatasets</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Statistics</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ds1 = NCDataset(joinpath(pwd(),&quot;..&quot;,&quot;..&quot;,&quot;data&quot;,&quot;trmmdaily&quot;,&quot;AR6_WAF&quot;,&quot;raw&quot;,&quot;2012&quot;,&quot;trmmdaily-AR6_WAF-201202.nc&quot;));</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ln1 = ds1[&quot;longitude&quot;][:];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; lt1 = ds1[&quot;latitude&quot;][:];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; prc = dropdims(mean(ds1[&quot;prcp_rate&quot;][:],dims=3),dims=3)</code><code class="nohighlight hljs ansi" style="display:block;">141×60 Matrix{Float32}:
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  …  NaN           NaN
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       1.19732f-8    0.0
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       1.19732f-8    0.0
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       0.0           0.0
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       0.0           0.0
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  …    1.19732f-8    0.0
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       0.0           0.0
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       0.0           0.0
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       0.0           0.0
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       0.0           0.0
   ⋮                        ⋮                 ⋱
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       1.60441f-7    2.15517f-8
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       1.3841f-6     1.49425f-6
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       5.79502f-7    1.17337f-7
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  …    6.65709f-7    1.46073f-7
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       2.01149f-7    2.39464f-9
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       4.78927f-7    2.20307f-7
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       5.81897f-7    3.08908f-7
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN       1.08477f-6    3.78352f-7
 NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  …  NaN             4.14272f-7</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; close(ds1)</code><code class="nohighlight hljs ansi" style="display:block;">closed NetCDF NCDataset</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ds2 = NCDataset(joinpath(pwd(),&quot;..&quot;,&quot;..&quot;,&quot;data&quot;,&quot;trmmlsm-AR6_WAF.nc&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">NCDataset: /home/runner/work/NASAPrecipitation.jl/NASAPrecipitation.jl/docs/build/examples/../../data/trmmlsm-AR6_WAF.nc
Group: /

Dimensions
   longitude = 141
   latitude = 60

Variables
  longitude   (141)
    Datatype:    Float32
    Dimensions:  longitude
    Attributes:
     units                = degrees_east
     long_name            = longitude

  latitude   (60)
    Datatype:    Float32
    Dimensions:  latitude
    Attributes:
     units                = degrees_north
     long_name            = latitude

  lsm   (141 × 60)
    Datatype:    Float32
    Dimensions:  longitude × latitude
    Attributes:
     units                = 0-1
     long_name            = land_sea_mask
     full_name            = Land-Sea Mask

Global attributes
  NCO                  = 4.5.1
  DOI                  = 10.5067/K1VR7BN7YDWN
  Description          = This TMPA land sea mask contains values ranging from 0% to 100% with 0% representing all land and 100% representing all ocean
  Authors              = Bill Olson, Dave Bolvin, George Huffman
  History              = This land sea mask originated from the NOAA group at SSEC in the 1980s. It was originally produced at 1/6 deg resolution, and then regridded for the purposes of GPCP, TMPA, and IMERG precipitation products. NASA code 610.2, Global Change Data Center, restructured this TMPA land sea mask to match the TMPA grid, and converted the file to CF-compliant netCDF4. Version 2 was created in May, 2019 to resolve detected inaccuracies in coastal regions.
  Version              = 2
  Title                = Land/Sea static mask relevant to TMPA precipitation 0.25x0.25 degree
  Conventions          = CF-1.4</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ln2 = ds2[&quot;longitude&quot;][:];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; lt2 = ds2[&quot;latitude&quot;][:];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; lsm = ds2[&quot;lsm&quot;][:];</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; close(ds2)</code><code class="nohighlight hljs ansi" style="display:block;">closed NetCDF NCDataset</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sum(ln1 .!== ln2) # Check to see if longitude coordinates are the same</code><code class="nohighlight hljs ansi" style="display:block;">0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sum(lt1 .!== lt2) # Check to see if latitude  coordinates are the same</code><code class="nohighlight hljs ansi" style="display:block;">0</code></pre><h2 id=".-Extract-data-over-land-and-over-the-ocea"><a class="docs-heading-anchor" href="#.-Extract-data-over-land-and-over-the-ocea">4. Extract data over land and over the ocea</a><a id=".-Extract-data-over-land-and-over-the-ocea-1"></a><a class="docs-heading-anchor-permalink" href="#.-Extract-data-over-land-and-over-the-ocea" title="Permalink"></a></h2><p>Using the <code>lsm</code> variable, we are able to separate out the data points over land and over ocean, assuming that values &gt;0.5 are for land, and values &lt;0.5 are over the ocean.</p><pre><code class="language-julia hljs">plnd = deepcopy(prc); plnd[lsm.&lt;0.5] .= NaN
pocn = deepcopy(prc); pocn[lsm.&gt;0.5] .= NaN</code></pre><h2 id=".-Plotting-the-data-using-ProPlot"><a class="docs-heading-anchor" href="#.-Plotting-the-data-using-ProPlot">5. Plotting the data using ProPlot</a><a id=".-Plotting-the-data-using-ProPlot-1"></a><a class="docs-heading-anchor-permalink" href="#.-Plotting-the-data-using-ProPlot" title="Permalink"></a></h2><p>We then proceed to plot the data for July and January, and the difference between the two.  I use the Python package ProPlot in my example, which can be called in Julia using PyCall, but this can be replicated.</p><p>First, I load the coastlines for me the plot (you need your own coastline file)</p><pre><code class="language-julia hljs">coord = readdlm(&quot;coastline.txt&quot;,comments=true,comment_char=&#39;#&#39;)
x = coord[:,1]
y = coord[:,2]</code></pre><p>Next, I load the bounds and the shape of the <code>AR6_WAF</code> <code>GeoRegion</code></p><pre><code class="language-julia hljs">blon,blat,slon,slat = coordGeoRegion(geo)</code></pre><p>Finally, I do the plotting as below:</p><pre><code class="language-julia hljs">using PyCall, LaTeXStrings
pplt = pyimport(&quot;proplot&quot;)

pplt.close(); f,a = pplt.subplots(nrows=2,ncols=2,aspect=9/4,axwidth=3)

a[1].pcolormesh(lon,lat,prc&#39;*86400,cmap=&quot;Blues&quot;,levels=(0:10)*2,extend=&quot;max&quot;)
a[1].plot(x,y,c=&quot;k&quot;,lw=0.5)
a[1].plot(blon,blat,c=&quot;b&quot;,lw=1,linestyle=&quot;:&quot;)
a[1].plot(slon,slat,c=&quot;b&quot;,lw=1)
a[1].format(ultitle=&quot;(a) All Data&quot;)

c = a[2].pcolormesh(lon,lat,lsm&#39;,cmap=&quot;delta&quot;,levels=0:0.1:1,extend=&quot;both&quot;)
a[2].plot(x,y,c=&quot;k&quot;,lw=0.5)
a[2].plot(blon,blat,c=&quot;b&quot;,lw=1,linestyle=&quot;:&quot;)
a[2].plot(slon,slat,c=&quot;b&quot;,lw=1)
a[2].colorbar(c,loc=&quot;r&quot;)
a[2].format(ultitle=&quot;(b) Land-Sea Mask&quot;)

a[3].pcolormesh(lon,lat,plnd&#39;*86400,cmap=&quot;Blues&quot;,levels=(0:10)*2,extend=&quot;max&quot;)
a[3].plot(x,y,c=&quot;k&quot;,lw=0.5)
a[3].plot(blon,blat,c=&quot;b&quot;,lw=1,linestyle=&quot;:&quot;)
a[3].plot(slon,slat,c=&quot;b&quot;,lw=1)
a[3].format(ultitle=&quot;(c) Land Data&quot;)

c = a[4].pcolormesh(lon,lat,pocn&#39;*86400,cmap=&quot;Blues&quot;,levels=(0:10)*2,extend=&quot;max&quot;)
a[4].plot(x,y,c=&quot;k&quot;,lw=0.5)
a[4].plot(blon,blat,c=&quot;b&quot;,lw=1,linestyle=&quot;:&quot;)
a[4].plot(slon,slat,c=&quot;b&quot;,lw=1)
a[4].colorbar(c,loc=&quot;r&quot;)
a[4].format(ultitle=&quot;(d) Ocean Data&quot;)

for ax in a
    ax.format(
        xlim=(-25,20),xlabel=L&quot;Longitude / $\degree$&quot;,
        ylim=(-2.5,17.5),ylabel=L&quot;Latitude / $\degree$&quot;,
        suptitle=L&quot;Precipitation Rate / mm day$^{-1}$&quot;
    )
end</code></pre><p><img src="trmmlsm.png" alt="trmmlsm"/></p><p>As we can see, we can use the land-sea mask to separate out points over land and over sea within the <code>GeoRegion</code></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="download.html">« Downloading IMERG Data</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Wednesday 25 August 2021 05:38">Wednesday 25 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
