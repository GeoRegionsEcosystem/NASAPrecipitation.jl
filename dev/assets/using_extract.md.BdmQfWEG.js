import{_ as p,C as l,c as o,o as d,aA as e,j as a,G as i,a as r,w as t}from"./chunks/framework.qRSDF92r.js";const x=JSON.parse('{"title":"Extracting data from existing data into a subGeoRegion","description":"","frontmatter":{},"headers":[],"relativePath":"using/extract.md","filePath":"using/extract.md","lastUpdated":null}'),h={name:"using/extract.md"},c={class:"jldocstring custom-block",open:""};function g(k,s,u,E,m,y){const n=l("Badge");return d(),o("div",null,[s[6]||(s[6]=e(`<h1 id="Extracting-data-from-existing-data-into-a-subGeoRegion" tabindex="-1">Extracting data from existing data into a subGeoRegion <a class="header-anchor" href="#Extracting-data-from-existing-data-into-a-subGeoRegion" aria-label="Permalink to &quot;Extracting data from existing data into a subGeoRegion {#Extracting-data-from-existing-data-into-a-subGeoRegion}&quot;">​</a></h1><p>One of the drawbacks of retrieving data from the OPeNDAP server is that the connection is slower than using the direct-download method. This cost can become especially noticeable when we are attempting to retrieve data for smaller regions of interest, where the lag caused by opening and closing remote datasets can add up and even take a longer time than doing a direct download.</p><p>Thus, drawing upon the functionality of <code>extractGrid()</code> in GeoRegions.jl, we have added in the ability to extract data for a smaller GeoRegion, provided that data for a larger GeoRegion has already been downloaded.</p><p>The extraction of data is as easy as</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>extract(</span></span>
<span class="line"><span>    &lt;NASAPrecipitation Dataset&gt;,</span></span>
<span class="line"><span>    &lt;subGeoRegion&gt;,</span></span>
<span class="line"><span>    &lt;parentGeoRegion&gt;,</span></span>
<span class="line"><span>)</span></span></code></pre></div><h3 id="Setup" tabindex="-1">Setup <a class="header-anchor" href="#Setup" aria-label="Permalink to &quot;Setup {#Setup}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NASAPrecipitation</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CairoMakie</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DelimitedFiles</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">download</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://raw.githubusercontent.com/natgeo-wong/GeoPlottingData/main/coastline_resl.txt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;coast.cst&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coast </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> readdlm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;coast.cst&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,comments</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">clon  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> coast[:,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">clat  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> coast[:,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span></code></pre></div><h2 id="An-Example:-Extracting-Data-for-Southeast-Asia-from-a-larger-Tropical-Domain" tabindex="-1">An Example: Extracting Data for Southeast Asia from a larger Tropical Domain <a class="header-anchor" href="#An-Example:-Extracting-Data-for-Southeast-Asia-from-a-larger-Tropical-Domain" aria-label="Permalink to &quot;An Example: Extracting Data for Southeast Asia from a larger Tropical Domain {#An-Example:-Extracting-Data-for-Southeast-Asia-from-a-larger-Tropical-Domain}&quot;">​</a></h2><p>Let&#39;s define the Tropical Domain and download some NASAPrecipitation data for this region:</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>npd = TRMMMonthly(start=Date(2015),stop=Date(2015))</span></span>
<span class="line"><span>pgeo = RectRegion(&quot;TRP&quot;,&quot;GLB&quot;,&quot;Tropics&quot;,[30,-30,360,0],savegeo=false)</span></span>
<span class="line"><span>download(npd,pgeo)</span></span></code></pre></div><p>We then proceed to define a subGeoRegion, and then extract the data</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sgeo = GeoRegion(&quot;AR6_SEA&quot;)</span></span>
<span class="line"><span>extract(npd,sgeo,pgeo)</span></span></code></pre></div><p>Now, let us proceed to compare and contrast the two Regions</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ds = read(npd,pgeo,Date(2015))</span></span>
<span class="line"><span>prcp_pgeo = ds[&quot;precipitation&quot;][:,:,:] * 3600</span></span>
<span class="line"><span>lsd_pgeo  = getLandSea(npd,pgeo)</span></span>
<span class="line"><span>close(ds)</span></span>
<span class="line"><span>ds = read(npd,sgeo,Date(2015))</span></span>
<span class="line"><span>prcp_sgeo = ds[&quot;precipitation&quot;][:,:,:] * 3600</span></span>
<span class="line"><span>lsd_sgeo  = getLandSea(npd,sgeo)</span></span>
<span class="line"><span>close(ds)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>fig = Figure()</span></span>
<span class="line"><span>_,_,slon,slat = coordGeoRegion(sgeo)</span></span>
<span class="line"><span>aspect = (maximum(slon)-minimum(slon)+90)/(maximum(slat)-minimum(slat)+30)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ax = Axis(</span></span>
<span class="line"><span>    fig[1,1],width=750,height=750/aspect,</span></span>
<span class="line"><span>    title=&quot;February 2015&quot;,xlabel=&quot;Longitude / º&quot;,ylabel=&quot;Latitude / º&quot;,</span></span>
<span class="line"><span>    limits=(minimum(slon)-45,maximum(slon)+45,minimum(slat)-15,maximum(slat)+15)</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span>contourf!(</span></span>
<span class="line"><span>    ax,lsd_pgeo.lon,lsd_pgeo.lat,prcp_pgeo[:,:,2],colormap=:Greens,</span></span>
<span class="line"><span>    levels=range(0,0.5,length=11),extendlow=:auto,extendhigh=:auto</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span>contourf!(</span></span>
<span class="line"><span>    ax,lsd_sgeo.lon,lsd_sgeo.lat,prcp_sgeo[:,:,2],colormap=:Blues,</span></span>
<span class="line"><span>    levels=range(0,0.5,length=11),extendlow=:auto,extendhigh=:auto</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span>lines!(ax,clon,clat,color=:black)</span></span>
<span class="line"><span>lines!(ax,slon,slat,color=:red,linewidth=5)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>resize_to_layout!(fig)</span></span>
<span class="line"><span>fig</span></span></code></pre></div><h2 id="API" tabindex="-1">API <a class="header-anchor" href="#API" aria-label="Permalink to &quot;API {#API}&quot;">​</a></h2>`,15)),a("details",c,[a("summary",null,[s[0]||(s[0]=a("a",{id:"RegionGrids.extract",href:"#RegionGrids.extract"},[a("span",{class:"jlbinding"},"RegionGrids.extract")],-1)),s[1]||(s[1]=r()),i(n,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[4]||(s[4]=e(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    npd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NASAPrecipitationDataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    geo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GeoRegion</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span></span></code></pre></div><p>Extracts NASAPrecipitation data for a GeoRegion <code>geo</code> from its parent GeoRegion <code>geo.pID</code>.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Data for the parent GeoRegion identified by <code>geo.pID</code> must already exist.</p></div><p><strong>Arguments</strong></p><ul><li><p><code>npd</code> : a <code>NASAPrecipitationDataset</code> specifying the dataset details and date download range</p></li><li><p><code>geo</code> : a <code>GeoRegion</code> (see <a href="https://github.com/GeoRegionsEcosystem/GeoRegions.jl" target="_blank" rel="noreferrer">GeoRegions.jl</a>) that sets the geographic bounds of the data array in lon-lat</p></li></ul>`,5)),i(n,{type:"info",class:"source-link",text:"source"},{default:t(()=>[...s[2]||(s[2]=[a("a",{href:"https://github.com/GeoRegionsEcosystem/NASAPrecipitation.jl/blob/624a3d477d8ac99e73faa3b66730dc8c1c7e1bfe/src/extract.jl#L1-L16",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1}),s[5]||(s[5]=e(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">extract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    npd  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NASAPrecipitationDataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sgeo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GeoRegion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    pgeo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GeoRegion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span></span></code></pre></div><p>Extracts NASAPrecipitation data for a GeoRegion <code>sgeo</code> from a bigger GeoRegion <code>pgeo</code>.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Data for the parent GeoRegion identified by <code>pgeo</code> must already exist, and <code>sgeo</code> must be fully within the bounds of <code>pgeo</code>.</p></div><p><strong>Arguments</strong></p><ul><li><p><code>npd</code> : a <code>NASAPrecipitationDataset</code> specifying the dataset details and date download range</p></li><li><p><code>sgeo</code> : a <code>GeoRegion</code> (see <a href="https://github.com/GeoRegionsEcosystem/GeoRegions.jl" target="_blank" rel="noreferrer">GeoRegions.jl</a>) that sets the geographic bounds of the data array in lon-lat</p></li><li><p><code>pgeo</code> : a <code>GeoRegion</code> that is a &quot;parent&quot; of the <code>GeoRegion</code> of interest <code>sgeo</code>, in the sense that <code>sgeo</code> must be fully within <code>pgeo</code>.</p></li></ul>`,5)),i(n,{type:"info",class:"source-link",text:"source"},{default:t(()=>[...s[3]||(s[3]=[a("a",{href:"https://github.com/GeoRegionsEcosystem/NASAPrecipitation.jl/blob/624a3d477d8ac99e73faa3b66730dc8c1c7e1bfe/src/extract.jl#L65-L82",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const f=p(h,[["render",g]]);export{x as __pageData,f as default};
